<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>monsteRbashSeq - Bioconductor, Microarray, R</title><link href="https://ljcohen.github.io/blog/" rel="alternate"></link><link href="https://ljcohen.github.io/blog/feeds/bioconductor-microarray-r.atom.xml" rel="self"></link><id>https://ljcohen.github.io/blog/</id><updated>2013-10-17T15:11:00-07:00</updated><entry><title>ExpressionSet success!!</title><link href="https://ljcohen.github.io/blog/expressionset-success.html" rel="alternate"></link><published>2013-10-17T15:11:00-07:00</published><updated>2013-10-17T15:11:00-07:00</updated><author><name>monsterbashseq</name></author><id>tag:ljcohen.github.io,2013-10-17:/blog/expressionset-success.html</id><summary type="html">&lt;p&gt;Behold, the ExpressionSet object:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; sponge_ExpressionSet&amp;amp;lt;-new(&amp;quot;ExpressionSet&amp;quot;,exprs=sponge_data,phenoData=pd,experimentData=experimentData,featureData=an)
&amp;amp;gt; sponge_ExpressionSet
ExpressionSet (storageMode: lockedEnvironment)
assayData: 15744 features, 72 samples 
  element names: exprs 
protocolData: none
phenoData
  sampleNames: 1_1 1_2 ... 9_8 (72 total)
  varLabels: Chip Number File Name ... Name (9 total)
  varMetadata: labelDescription
featureData …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;Behold, the ExpressionSet object:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; sponge_ExpressionSet&amp;amp;lt;-new(&amp;quot;ExpressionSet&amp;quot;,exprs=sponge_data,phenoData=pd,experimentData=experimentData,featureData=an)
&amp;amp;gt; sponge_ExpressionSet
ExpressionSet (storageMode: lockedEnvironment)
assayData: 15744 features, 72 samples 
  element names: exprs 
protocolData: none
phenoData
  sampleNames: 1_1 1_2 ... 9_8 (72 total)
  varLabels: Chip Number File Name ... Name (9 total)
  varMetadata: labelDescription
featureData
  featureNames: 1 2 ... 15744 (15744 total)
  fvarLabels: Column Row ... X.1 (23 total)
  fvarMetadata: labelDescription
experimentData: use &amp;#39;experimentData(object)&amp;#39;
Annotation:
&lt;/pre&gt;&lt;/div&gt;</content></entry><entry><title>Error in validObject(.Object)</title><link href="https://ljcohen.github.io/blog/error-in-validobject-object.html" rel="alternate"></link><published>2013-10-17T13:25:00-07:00</published><updated>2013-10-17T13:25:00-07:00</updated><author><name>monsterbashseq</name></author><id>tag:ljcohen.github.io,2013-10-17:/blog/error-in-validobject-object.html</id><summary type="html">&lt;p&gt;Biobase's  "ExpressionSet" package:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sponge_ExpressionSet&amp;amp;lt;-new(&amp;quot;ExpressionSet&amp;quot;,exprs=sponge_data,phenoData=pd,experimentData=experimentData,featureData=an)
Error in validObject(.Object) : 
  invalid class “ExpressionSet” object: 1: featureNames differ between assayData and featureData
invalid class “ExpressionSet” object: 2: sampleNames differ between assayData and phenoData
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It is looking for the same data in all …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Biobase's  "ExpressionSet" package:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sponge_ExpressionSet&amp;amp;lt;-new(&amp;quot;ExpressionSet&amp;quot;,exprs=sponge_data,phenoData=pd,experimentData=experimentData,featureData=an)
Error in validObject(.Object) : 
  invalid class “ExpressionSet” object: 1: featureNames differ between assayData and featureData
invalid class “ExpressionSet” object: 2: sampleNames differ between assayData and phenoData
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It is looking for the same data in all sets to match. I need to figure
out how it wants featureNames and sampleNames to be specified, row
headers? a column of data?&lt;/p&gt;
&lt;p&gt;http://stackoverflow.com/questions/7363991/expressionset-phenodata&lt;/p&gt;
&lt;p&gt;http://grokbase.com/t/r/bioconductor/12c6e2j6ba/bioc-oligo-package&lt;/p&gt;
&lt;p&gt;http://www.hsph.harvard.edu/carey/lect3dstr.pdf&lt;/p&gt;</content></entry><entry><title>Building An ExpressionSet From Scratch</title><link href="https://ljcohen.github.io/blog/building-an-expressionset-from-scratch.html" rel="alternate"></link><published>2013-10-16T12:57:00-07:00</published><updated>2013-10-16T12:57:00-07:00</updated><author><name>monsterbashseq</name></author><id>tag:ljcohen.github.io,2013-10-16:/blog/building-an-expressionset-from-scratch.html</id><summary type="html">&lt;p&gt;http://www.bioconductor.org/packages/2.13/bioc/vignettes/Biobase/inst/doc/ExpressionSetIntroduction.pdf&lt;/p&gt;
&lt;p&gt;http://www.bioconductor.org/help/course-materials/2006/biocintro_oct/labs/ExpressionSet/ExpressionSetIntro-lab.pdf&lt;/p&gt;
&lt;p&gt;1.Make sure raw microarray data are in a matrix of the appropriate
dimensions.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; class(sponge_data) 
[1] &amp;quot;data.frame&amp;quot;
&amp;amp;gt; matrix_sponge_data&amp;amp;lt;-as …&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;http://www.bioconductor.org/packages/2.13/bioc/vignettes/Biobase/inst/doc/ExpressionSetIntroduction.pdf&lt;/p&gt;
&lt;p&gt;http://www.bioconductor.org/help/course-materials/2006/biocintro_oct/labs/ExpressionSet/ExpressionSetIntro-lab.pdf&lt;/p&gt;
&lt;p&gt;1.Make sure raw microarray data are in a matrix of the appropriate
dimensions.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; class(sponge_data) 
[1] &amp;quot;data.frame&amp;quot;
&amp;amp;gt; matrix_sponge_data&amp;amp;lt;-as.matrix(sponge_data)
&amp;amp;gt; class(matrix_sponge_data)
[1] &amp;quot;matrix&amp;quot;
&amp;amp;gt; dim(matrix_sponge_data)
[1] 15744    77
&amp;amp;gt; colnames(matrix_sponge_data)
 [1] &amp;quot;initial_blockdata.RefNumber&amp;quot; &amp;quot;initial_blockdata.ID&amp;quot;       
 [3] &amp;quot;initial_blockdata.Name&amp;quot;      &amp;quot;initial_blockdata.Row&amp;quot;      
 [5] &amp;quot;initial_blockdata.Column&amp;quot;    &amp;quot;Block 1 Chip 1&amp;quot;             
 [7] &amp;quot;Block 2 Chip 1&amp;quot;              &amp;quot;Block 3 Chip 1&amp;quot;             
 [9] &amp;quot;Block 4 Chip 1&amp;quot;              &amp;quot;Block 5 Chip 1&amp;quot;             
[11] &amp;quot;Block 6 Chip 1&amp;quot;              &amp;quot;Block 7 Chip 1&amp;quot;             
[13] &amp;quot;Block 8 Chip 1&amp;quot;              &amp;quot;Block 1 Chip 2&amp;quot;             
[15] &amp;quot;Block 2 Chip 2&amp;quot;              &amp;quot;Block 3 Chip 2&amp;quot;             
[17] &amp;quot;Block 4 Chip 2&amp;quot;              &amp;quot;Block 5 Chip 2&amp;quot;             
[19] &amp;quot;Block 6 Chip 2&amp;quot;              &amp;quot;Block 7 Chip 2&amp;quot;             
[21] &amp;quot;Block 8 Chip 2&amp;quot;              &amp;quot;Block 1 Chip 3&amp;quot;             
[23] &amp;quot;Block 2 Chip 3&amp;quot;              &amp;quot;Block 3 Chip 3&amp;quot;             
[25] &amp;quot;Block 4 Chip 3&amp;quot;              &amp;quot;Block 5 Chip 3&amp;quot;             
[27] &amp;quot;Block 6 Chip 3&amp;quot;              &amp;quot;Block 7 Chip 3&amp;quot;             
[29] &amp;quot;Block 8 Chip 3&amp;quot;              &amp;quot;Block 1 Chip 4&amp;quot;             
[31] &amp;quot;Block 2 Chip 4&amp;quot;              &amp;quot;Block 3 Chip 4&amp;quot;             
[33] &amp;quot;Block 4 Chip 4&amp;quot;              &amp;quot;Block 5 Chip 4&amp;quot;             
[35] &amp;quot;Block 6 Chip 4&amp;quot;              &amp;quot;Block 7 Chip 4&amp;quot;             
[37] &amp;quot;Block 8 Chip 4&amp;quot;              &amp;quot;Block 1 Chip 5&amp;quot;             
[39] &amp;quot;Block 2 Chip 5&amp;quot;              &amp;quot;Block 3 Chip 5&amp;quot;             
[41] &amp;quot;Block 4 Chip 5&amp;quot;              &amp;quot;Block 5 Chip 5&amp;quot;             
[43] &amp;quot;Block 6 Chip 5&amp;quot;              &amp;quot;Block 7 Chip 5&amp;quot;             
[45] &amp;quot;Block 8 Chip 5&amp;quot;              &amp;quot;Block 1 Chip 6&amp;quot;             
[47] &amp;quot;Block 2 Chip 6&amp;quot;              &amp;quot;Block 3 Chip 6&amp;quot;             
[49] &amp;quot;Block 4 Chip 6&amp;quot;              &amp;quot;Block 5 Chip 6&amp;quot;             
[51] &amp;quot;Block 6 Chip 6&amp;quot;              &amp;quot;Block 7 Chip 6&amp;quot;             
[53] &amp;quot;Block 8 Chip 6&amp;quot;              &amp;quot;Block 1 Chip 7&amp;quot;             
[55] &amp;quot;Block 2 Chip 7&amp;quot;              &amp;quot;Block 3 Chip 7&amp;quot;             
[57] &amp;quot;Block 4 Chip 7&amp;quot;              &amp;quot;Block 5 Chip 7&amp;quot;             
[59] &amp;quot;Block 6 Chip 7&amp;quot;              &amp;quot;Block 7 Chip 7&amp;quot;             
[61] &amp;quot;Block 8 Chip 7&amp;quot;              &amp;quot;Block 1 Chip 8&amp;quot;             
[63] &amp;quot;Block 2 Chip 8&amp;quot;              &amp;quot;Block 3 Chip 8&amp;quot;             
[65] &amp;quot;Block 4 Chip 8&amp;quot;              &amp;quot;Block 5 Chip 8&amp;quot;             
[67] &amp;quot;Block 6 Chip 8&amp;quot;              &amp;quot;Block 7 Chip 8&amp;quot;             
[69] &amp;quot;Block 8 Chip 8&amp;quot;              &amp;quot;Block 1 Chip 9&amp;quot;             
[71] &amp;quot;Block 2 Chip 9&amp;quot;              &amp;quot;Block 3 Chip 9&amp;quot;             
[73] &amp;quot;Block 4 Chip 9&amp;quot;              &amp;quot;Block 5 Chip 9&amp;quot;             
[75] &amp;quot;Block 6 Chip 9&amp;quot;              &amp;quot;Block 7 Chip 9&amp;quot;             
[77] &amp;quot;Block 8 Chip 9&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;2. Make a minimal ExpressionSet, just to check:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; minimalSet&amp;amp;lt;-ExpressionSet(assayData=matrix_sponge_data)
&amp;amp;gt; head(minimalSet)
ExpressionSet (storageMode: lockedEnvironment)
assayData: 1 features, 77 samples 
  element names: exprs 
protocolData: none
phenoData: none
featureData: none
experimentData: use &amp;#39;experimentData(object)&amp;#39;
Annotation:
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;3. Load Phenotype Data, which summarizes the information about the
samples, experimental treatments, covariates, etc.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; samples&amp;amp;lt;-read.csv(&amp;quot;targets_experiment_sample_info.csv&amp;quot;,header=TRUE,check.names=FALSE)
&amp;amp;gt; head(samples)
  Chip Number                   File Name Hyb Date Tank Treatment Colony
1           1 253295110067_2012-08-01.txt 8/1/2012   C3        UC      P
2           1 253295110067_2012-08-01.txt 8/1/2012   B2        UD      P
3           1 253295110067_2012-08-01.txt 8/1/2012   B2        UD      O
4           1 253295110067_2012-08-01.txt 8/1/2012   D3        OD     BL
5           1 253295110067_2012-08-01.txt 8/1/2012   D1        OD      O
6           1 253295110067_2012-08-01.txt 8/1/2012   C3        UC      O
  Raceway Block
1       B     1
2       A     2
3       A     3
4       A     4
5       B     5
6       B     6
&amp;amp;gt; class(samples)
[1] &amp;quot;data.frame&amp;quot;
&amp;amp;gt; samples_matrix&amp;amp;lt;-as.matrix(samples)
&amp;amp;gt; all(rownames(samples_matrix)==colnames(matrix_sponge_data))
[1] TRUE
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;4. Load Annotation file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; annotation&amp;amp;lt;-read.csv(&amp;quot;FeatAnnotFile_SEE_10-18-12.csv&amp;quot;,header=TRUE,check.name=FALSE)
&amp;amp;gt; class(annotation)
[1] &amp;quot;data.frame&amp;quot;
&amp;amp;gt; annotation_matrix&amp;amp;lt;-as.matrix(annotation)
&amp;amp;gt; class(annotation_matrix)
[1] &amp;quot;matrix&amp;quot;
&amp;amp;gt; all(rownames(annotation_matrix)==rownames(matrix_sponge_data))
[1] TRUE
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;5. Experiment Description:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; experimentData&amp;amp;lt;-new(&amp;quot;MIAME&amp;quot;,name=&amp;quot;Sara Edge, Lisa Cohen&amp;quot;,
                              lab=&amp;quot;Marine Genomics, HBOI&amp;quot;,
                              contact=&amp;quot;lcohen49@hboi.fau.edu&amp;quot;,
                              title=&amp;quot;Sponge Oil Dispersant Exposure Experiment&amp;quot;,
                              abstract=&amp;quot;ExpressionSet for Sponge Microarray Data&amp;quot;,
                              other=list(notes=&amp;quot;Created from GenePix *.gal files&amp;quot;))
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;6. Assemble ExpressionSet:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&amp;amp;gt; sponge_ExpressionSet&amp;amp;lt;-new(&amp;quot;ExpressionSet&amp;quot;,exprs=sponge_data,phenoData=samples_matrix,experimentData=experimentData,annotation=annotation_matrix)
Error: ExpressionSet &amp;#39;phenoData&amp;#39; is class &amp;#39;matrix&amp;#39; but should be or extend &amp;#39;AnnotatedDataFrame&amp;#39;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;But, I got the error in red above.&lt;/p&gt;</content></entry></feed>